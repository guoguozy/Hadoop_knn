# 课程设计报告

## 选题

- 选择的题目为1.3机器学习算法：KNN

- 具体的题目是鸢尾花分类问题，来自[ http://archive.ics.uci.edu/ml/datasets/Iris ](http://archive.ics.uci.edu/ml/datasets/Iris)

- 使用的是著名的鸢尾花数据集。据集内包含 3 类共 150 条记录，每类各 50 个数据，每条记录都有 4 项特征：花萼长度、花萼宽度、花瓣长度、花瓣宽度，可以通过这4个特征预测鸢尾花卉属于（iris-setosa, iris-versicolour, iris-virginica）中的哪一品种。

  训练集中数据为：属性值1，属性值2，.......，标签

  测试集中数据为：属性值1，属性值2，.......,   正确标签

## 实验目的&内容

- 实现KNN算法在Hadoop平台基于***欧拉距离***，***加权欧拉距离***，***高斯函数***的MapReduce实现。
- 特色或创意：在网上KNN实现的例子上添加了基于***欧拉距离***，***加权欧拉距离***，***高斯函数***的实现。

## github仓库

[github.com/guoguozy28/Hadoop_Knn](https://github.com/guoguozy/Hadoop_knn )

## 实验过程

1. 编写KNN.java代码

   在之前实验3的代码以及网上关于KNN的代码上作为参考，将训练集和测试集读入进行计算，再根据不同距离计算方法，在原来的基础上进行改造，对获取设定k值的前k个数据阶段，进行计算。

   具体的代码解析与描述此处就不一一赘述，详见github仓库的README

2. 配置环境

   配置环境只需根据之前实验2,3配置一遍即可，我这里是直接采用超算习堂的环境来编译运行

3. 编译运行

   将代码以及测试集、训练集upload到超算习堂上，然后按照实验三的步骤

   其中knn工作目录下为 KNN.java，train（训练集文件夹），test（测试集文件夹）
   
   然后按照下列步骤编译运行
   
   ```
   javac KNN.java
   jar cvf KNN.jar ./KNN*.class
   /usr/local/hadoop/bin/hadoop jar KNN.jar KNN train output
   ```
   如图：
   
   <img src="../knn/img/2.png" style="zoom:67%;" />
   
4. 然后将不同的计算方法注释掉，测试不同的计算方法下得出的结果。
## 成果截图

运行得到的截图如下：
   <img src="E:\book\云计算实践\knn\img\3.png" style="zoom: 50%;" />
   <img src="E:\book\云计算实践\knn\img\4.png" style="zoom: 67%;" />
用vim打开输出文件：
   <img src="E:\book\云计算实践\knn\img\1.png" style="zoom:67%;" />

很不巧，经过我的比较三种计算方法得到的结果都是一样的，如上面这张图所示。所以就不再多展示两张一样的图在这里了。（具体的结果可以在github仓库的result文件夹中查看）

比对了一下，测试集中的正确结果和计算得出的结果，30个中只错了1个，正确率还是不错的。

## 遇到问题与解决方法

- 排序问题

  如何对”标签+距离“的list数组进行排序，这个问题困扰了我许久。最终使用了 Collections.sort方法并重写其compare方法即可，将其compare方法改为将字符串中距离部分提取出来进行排序返回结果，实现了对定制数据的排序。 

-  取值问题

  我在计算list数组中元素数目然后找出最大值处也遇到了问题。但查找可调库的函数无果，只得将数组去重得到标签，然后new一个数组对原数组遍历来进行计数。得到计数数组后还要求最大数所在的索引，再设置一个max变量记录最大值所在的索引，遍历数组，如果比当前的max大则将max改为该值的索引。 

- 实现问题

  在实现算法的时候不要上来就一股脑地输出，很可能是徒劳无功。一定要是先将每一步做什么想好来在动手，可以省去许多时间。

  

